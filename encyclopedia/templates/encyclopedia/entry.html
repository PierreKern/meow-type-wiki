{% extends "encyclopedia/layout.html" %}

{% block title %}
    {{ title }}
{% endblock %}

{% block body %}

    <div class="markdown-body">
        {{ content | safe }}
    </div>

    <form action="{% url 'edit' %}" method="POST" class="mt-3">
        {% csrf_token %}
        <input type="hidden" name="entry_title" value="{{ title }}">
        <input class="btn btn-dark" type="submit" value="Edit page">
    </form>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <script type="module">
        import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("pre > code.language-mermaid").forEach((block) => {

            const mermaidDiv = document.createElement("div");
            mermaidDiv.classList.add("mermaid");
            mermaidDiv.textContent = block.textContent;
            block.parentElement.replaceWith(mermaidDiv);
        });

        if (window.mermaid) {
            mermaid.initialize({ startOnLoad: true });
            mermaid.init();
        }
    });
    </script>

{% endblock %}
